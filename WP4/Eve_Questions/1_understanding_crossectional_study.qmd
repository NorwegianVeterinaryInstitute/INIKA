---
title: "Eve : Understanding cross sectional study"
format: html
editor: visual
---

# Context

Reviewing Maulid phD proposal

# Questions 1.

One of "Kish Leslie’s formula" to estimate prevalence of event in cross-sectional studies.

$$n = \frac{Z^2 \cdot P \cdot (1-P)}{d^2}$$

> from google gemini 2025-05-16

! Assumtions for random sampling

-   n: (minimum) Required sample size
-   Z: Z-score corresponding to the desired level of confidence for statistical analysis eg. 1.96 for 95% confidence level, 2.58 for 99% confidence level
-   P: Expected prevalence or proportion of the characteristic in the population. (This can be estimated from previous studies, pilot data, or a literature review. If P is unknown, it is common to use P = 0.5 (or 50%). This value maximizes the required sample size, ensuring your study is adequately powered, as it represents the point of maximum variability for a **binomial distribution**.)

<!-- so we are in the binomial case, it is or it is not ...  event observed --->

-   d: Desired level of precision or margin of error (also called absolute precision). This is the maximum acceptable difference between your sample estimate and the true population (prevalence) value.

For example, if you want your estimate to be within \$\pm\$5% of the true prevalence, d would be 0.05.

! if cluster sampling (non independence of samples, individuals more similar to each other than selected randomly in the population), need to correct using a design effect (DEFF).

$$n_{cluster} = n \cdot DEFF $$

Formula when dealing with weights $$n_{\text{eff}} = \frac{\left(\sum w_i\right)^2}{\sum \left(w_i^2\right)}$$ To use when unequal probabilities of selection or non response =\> I did not use here. I assume its the same.

> Gemini: This n_eff tells you what an equivalent sample size would be if you had used simple random sampling, in terms of precision. The design effect (deff) is related to this, often calculated as the actual sample size divided by the effective sample size

$$deff = \frac{n}{n_{eff}} $$

! expected non response rate (or maybe that you will not be able to realize what you plan ? ) adjust your initial sample size upwards to ensure you achieve the desired final sample size. NRR = estimated (expected) non-response rate \> Formula n final ​ =n calculated ​ /(1−NRR)

! Multiple objective -\> calculate required sample size for each important variable/objective -\> choose the largest (so can be used for all outcome)

```{=html}
<!--  Epi Info (from the CDC) is a commonly used free tool for epidemiologists that includes sample size calculation capabilities.
Includes cohort

https://www.cdc.gov/epiinfo/user-guide/statcalc/cohortandcrosssectional.html#:~:text=The%20Cohort%20and%20Cross%2DSectional,and%20the%20desired%20confidence%20level.
-->
```

------------------------------------------------------------------------

Maulid: prevalence of fecal carriage of ESBL Enterobacteriaceae in the adults is reported to be 16.3% (70) and that of children is 33.1% (71)

So checking what he did

```{r}
estimate_min_sampling_size <- function(z_score, p_prevalence, d_error) {
  
  (z_score^2*p_prevalence*(1-p_prevalence))/(d_error^2)
  
}
```

```{r}
Zscore = 1.96 
P_children = 0.331
P_adults = 0.163

# For children
n_children <- estimate_min_sampling_size(Zscore, P_children, 0.05)

# For adults
n_adults <- estimate_min_sampling_size(Zscore, P_adults, 0.05)
```

Correction for lack of independence: DEFF (1.5 - 2 ) apparently for ealth survey \> formula $n_cluster = n * DEFF$

```{r}
DEFF = seq(1.5,2, 0.1)

plot_min_n <- function(){
  
  
  
  
}
    
  
  

```

Non response rate correction (could also be samples that cant be compared one year over the other)

$$n_{final} =\frac {n_{calculated}} {1−NRR}$$

------------------------------------------------------------------------

Formula when dealing with weights $$n_{\text{eff}} = \frac{\left(\sum w_i\right)^2}{\sum \left(w_i^2\right)}$$
